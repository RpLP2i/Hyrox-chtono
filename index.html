<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>LP'ROX ‚Äì Chronom√®tre</title>

<style>
body {
    margin: 0;
    background: black;
    color: white;
    font-family: Arial, sans-serif;
}

/* ===== HEADER TOUJOURS VISIBLE ===== */
.header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 160px;
    display: flex;
    align-items: center;
    padding: 20px;
    z-index: 10;
    background: black;
}

.logo {
    height: 150px;
}

.title {
    flex: 1;
    text-align: center;
    font-size: 140px;
    font-weight: bold;
}

/* ===== CONTENU ===== */
.container {
    display: flex;
    height: calc(100vh - 160px);
    padding-top: 160px;
}

.left {
    flex: 2;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.time {
    font-size: 140px;
    font-weight: bold;
}

.controls {
    text-align: center;
    margin-top: 10px;
}

.controls input,
.controls button {
    font-size: 18px;
    padding: 6px 12px;
    margin: 5px;
    width: 90px;
}

.right {
    flex: 1;
    background: #111;
    padding: 15px;
    overflow-y: auto;
}

/* ===== TABLE ===== */
table {
    width: 100%;
    border-collapse: collapse;
    font-size: 16px;
}

th, td {
    border-bottom: 1px solid #444;
    padding: 6px;
    text-align: center;
}

button.teamStop {
    font-size: 64px;
    width: auto;
}
/* ===== BOUTONS CHRONO ‚Äì SANS CONTOUR ===== */
.controls button {
    background: black;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 64px;
    padding: 14px 22px;
    margin: 8px;
    cursor: pointer;

    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;

    outline: none;
}

.controls button:focus {
    outline: none;
}

.controls button:hover {
    background: #222;
}

.controls button:active {
    transform: scale(1,2);
}
</style>
</head>

<body>

<!-- ===== HEADER FIXE ===== -->
<div class="header">
    <img src="logo.png" class="logo">
    <div class="title">LP'ROX</div>
</div>

<div class="container">

    <div class="left">
        <div class="time" id="chrono">00:00:00</div>

        <!-- ===== R√âGLAGES (CACH√âS APR√àS D√âPART) ===== -->
        <div class="controls" id="settings">
            ‚è≥ Compte √† rebours (s)<br>
            <input type="number" id="countdown" value="10" min="0"><br>

            üë• Nombre d‚Äô√©quipes<br>
            <input type="number" id="teamsCount" value="5" min="1" max="30"><br>

            ‚è±Ô∏è D√©calage entre √©quipes<br>
            <input type="number" id="intervalMin" value="1" min="0"> min
            <input type="number" id="intervalSec" value="0" min="0" max="59"> sec
        </div>

        <!-- ===== COMMANDES TOUJOURS VISIBLES ===== -->
        <div class="controls">
           <button onclick="startRace()"><span class="icon">‚ñ∂Ô∏è</span></button>
<button onclick="pauseRace()"><span class="icon">‚è∏Ô∏è</span></button>
<button onclick="resumeRace()"><span class="icon">‚èØÔ∏è</span></button>
<button onclick="stopRace()"><span class="icon">‚èπÔ∏è</span></button>
        </div>
    </div>

    <!-- ===== TABLEAU ===== -->
    <div class="right">
        <h2>D√©parts √©quipes</h2>
        <table id="teamTable">
            <tr>
                <th>√âquipe</th>
                <th>D√©part</th>
                <th>Temps</th>
                <th>Arriv√©e</th>
            </tr>
        </table>
    </div>

</div>

<script>
let startTime = null;
let elapsed = 0;
let running = false;
let paused = false;
let chronoTimer = null;
let countdownTimer = null;
let teams = [];
let announced = [];

function speak(text) {
    const u = new SpeechSynthesisUtterance(text);
    u.lang = "fr-FR";
    u.rate = 0.85;
    u.pitch = 0.7;
    speechSynthesis.cancel();
    speechSynthesis.speak(u);
}

function format(ms) {
    if (ms < 0) return "--:--:--";
    const s = Math.floor(ms / 1000);
    const h = Math.floor(s / 3600);
    const m = Math.floor((s % 3600) / 60);
    const sec = s % 60;
    return `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(sec).padStart(2,'0')}`;
}

function generateTeams(count, intervalMs) {
    teams = [];
    announced = [];
    const table = document.getElementById("teamTable");
    table.innerHTML = `
        <tr><th>√âquipe</th><th>D√©part</th><th>Temps</th><th>Arriv√©e</th></tr>`;

    for (let i = 0; i < count; i++) {
        const delay = i * intervalMs;
        teams.push({ letter: String.fromCharCode(65 + i), delay, finished: false });
        announced.push(false);

        const row = table.insertRow();
        row.insertCell().innerText = teams[i].letter;

        const t = Math.floor(delay / 1000);
        row.insertCell().innerText = `${Math.floor(t/60)}m ${String(t%60).padStart(2,'0')}s`;

        row.insertCell().id = "time" + i;

        const btn = document.createElement("button");
        btn.innerText = "STOP";
        btn.onclick = () => stopTeam(i);
        row.insertCell().appendChild(btn);
    }
}

function startRace() {
    stopRace();
    document.getElementById("settings").style.display = "none";

    const cd = +countdown.value;
    const count = +teamsCount.value;
    const intervalMs = (+intervalMin.value * 60 + +intervalSec.value) * 1000;

    generateTeams(count, intervalMs);

    let remaining = cd;
    countdownTimer = setInterval(() => {
        if (remaining > 0) speak(remaining--);
        else {
            clearInterval(countdownTimer);
            speak("D√©part √©quipe A");
            startTime = Date.now();
            running = true;
            chronoTimer = setInterval(updateChrono, 100);
        }
    }, 1000);
}

function updateChrono() {
    if (!running || paused) return;
    elapsed = Date.now() - startTime;
    chrono.innerText = format(elapsed);

    teams.forEach((t, i) => {
        if (!t.finished && elapsed >= t.delay)
            document.getElementById("time"+i).innerText = format(elapsed - t.delay);
        if (!announced[i] && elapsed >= t.delay) {
            speak(`D√©part √©quipe ${t.letter}`);
            announced[i] = true;
        }
    });
}

function stopTeam(i) {
    if (!teams[i].finished) {
        teams[i].finished = true;
        document.getElementById("time"+i).innerText = format(elapsed - teams[i].delay);
    }
}

function pauseRace() { paused = true; }
function resumeRace() { paused = false; startTime = Date.now() - elapsed; }

function stopRace() {
    running = false;
    paused = false;
    clearInterval(chronoTimer);
    clearInterval(countdownTimer);
    chrono.innerText = "00:00:00";
    speechSynthesis.cancel();
}
</script>

</body>
</html>
